diff -urN tar-1.17/src/sparse.c CVE-2019-9923/src/sparse.c
--- tar-1.17/src/sparse.c	2019-12-11 15:55:34.031343593 +0800
+++ CVE-2019-9923/src/sparse.c	2019-12-11 15:58:04.024011400 +0800
@@ -1149,6 +1149,8 @@
 	 {                                                         \
 	   set_next_block_after (b);                               \
            b = find_next_block ();                                 \
+           if (!b)                                                 \
+             FATAL_ERROR ((0, 0, _("Unexpected EOF in archive"))); \
            src = b->buffer;                                        \
 	   endp = b->buffer + BLOCKSIZE;                           \
 	 }                                                         \
@@ -1161,6 +1163,8 @@
       start = current_block_ordinal ();
       set_next_block_after (current_header);
       blk = find_next_block ();
+      if (!blk)
+        FATAL_ERROR ((0, 0, _("Unexpected EOF in archive")));
       p = blk->buffer;
       COPY_BUF (blk,nbuf,p);
       if (!decode_num (&u, nbuf, TYPE_MAXIMUM (size_t)))
